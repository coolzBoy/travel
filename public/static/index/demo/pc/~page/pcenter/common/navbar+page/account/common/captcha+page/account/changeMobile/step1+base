fml.define("common/ptpParams",[],function(i,e){"use strict";window.PTP_PARAMS={EnableLogMoGuJs:!1,uuid:"__mgjuuid",uid:"__ud_",platform:function(){var i=navigator.userAgent;return i.indexOf("meilishuo4android")!=-1||i.indexOf("meilishuo android")!=-1?"24":i.indexOf("meilishuo4ios")!=-1||i.indexOf("Meilishuo iPhone")!=-1?"23":/iphone|android|ipad/i.test(i)?"34":"33"},hrefRe:/http[s]?:\/\/\w+\.(meilishuo|mogujie)\.com([\/]|\/.*|)$/,mgjRe:/(meilishuo|mls):\/\//,isNativeRe:/(meilishuo|mls|mogujie)/i,nativeLog:{}}});;fml.define("common/biu",[],function(o,t){"use strict";var n=function(){function o(){t.css("height",$(document).height()+"px")}var t=$(".biu-sidebar"),n=$(".biu-download"),e=$(".mls-qrcode");o(),$(window).resize(function(){o()}),n.hover(function(){e.css("display","block")},function(){e.css("display","none")}),$(window).scroll(function(){document.body.scrollTop?document.body.scrollTop>0?$(".biu-go2top").css("display","block"):$(".biu-go2top").css("display","none"):document.documentElement.scrollTop&&document.documentElement.scrollTop>0?$(".biu-go2top").css("display","block"):$(".biu-go2top").css("display","none")}),$(".biu-go2top").on("click",function(){window.scrollTo(0,0)}),$.ajax({type:"get",url:"http://cart.meilishuo.com/api/cart/getItemCount?marketType=market_meilishuo",dataType:"jsonp",success:function(o){var t=o||{};1001==t.status.code&&t.result&&t.result.count>0&&(t.result.count>99?$(".biu-cart-num").text("99+"):$(".biu-cart-num").text(t.result.count))},error:function(){console.log("--右侧栏 jsonp请求购物车商品数出错")}}),$.ajax({type:"get",url:"http://promotionnew.meilishuo.com/jsonp/getUnUsedCouponNumber/1?domain=11",dataType:"jsonp",success:function(o){var t=o||{};t.success&&t.data.number>0&&(t.data.number>99?$(".biu-coupon-num").text("99+"):$(".biu-coupon-num").text(t.data.number))},error:function(){console.log("--右侧栏 jsonp请求优惠券数出错")}}),$.ajax({type:"get",url:"http://webim.meilishuo.com/jsonp/cinfo/1",dataType:"jsonp",success:function(o){var t=o||{};t.success&&t.data.number>0&&$(".biu-service-num").text(t.data.number)},error:function(o,t){console.log("--右侧栏 jsonp请求客服消息数出错")}}),$(".biu-open-im").on("click",function(){var o=$(".biu-login").text();return""==o||"0"==o||null==o&&void 0!=o||" "==o?(window.open("https://account.meilishuo.com/user/login"),!1):(window._openIm(o,""),!1)})};n.prototype.biuAddCart=function(o){$.ajax({type:"get",url:"http://cart.meilishuo.com/api/cart/getItemCount?marketType=market_meilishuo",dataType:"jsonp",jsonp:"biuCartNum",success:function(t){var n=t||{};if(1001==n.status.code&&n.result&&n.result.count>0){var e=n.result.count+o;e>0&&e<100?$(".biu-cart-num").text(e):$(".biu-cart-num").text("99+")}}})};var e=new n;t.biuAddCart=e.biuAddCart});;fml.define("common/nav",[],function(t,i){"use strict";var a=$(".sec_attr .list");$(".nav_list");a.hover(function(){var t=$(this).children(".nav_list");0!=t.length&&(a.removeClass("active"),$(this).addClass("active"),t.show())},function(){a.removeClass("active"),$(this).removeClass("active"),$(this).children(".nav_list").hide()});var e=a.length;a.each(function(t){t==e-1&&$(this).addClass("last")});var n=$(".attr_box");"welcome"==Meilishuo.config.controller?n.css("display","block"):$(".all , .attr_box").hover(function(){n.stop(!0,!0).slideDown()},function(t){t.stopPropagation(),n.find(".nav_list").hide(),n.stop(!0,!0).slideUp()});var s={"/welcome":"首页","/brand/street":"品牌街","/officialDirect":"官网直邮","/select":"好物"},o="",l=location.pathname;$.each(s,function(t,i){if(0==l.indexOf(t))return o=s[t],!1}),"/"==l&&(o="首页");var c=$(".nav_tab");c.each(function(){var t=$(this).find("a").html();o==t&&$(this).find("a").addClass("active")})});;fml.define("common/search",[],function(t,e){"use strict";function a(t){t=t.list;for(var e="",a=0;a<t.length;a++){var o=t[a];e+='<a target="_blank" href="http://www.meilishuo.com/search/goods/?page=1&searchKey='+encodeURIComponent(o.word)+'" style="color:'+o.color+'">'+o.word+"</a >"}u.html(e)}function o(t){t&&t.list&&t.list.length&&(t=t.list[0],h.attr({placeholder:t.placehold,"data-placeholder":t.placehold,"data-key":t.word}))}function n(){$.ajax({url:"http://mce.meilishuo.com/jsonp/multiget/3?pids=5604,5571",dataType:"jsonp"}).then(function(t){t.success&&(a(t.data[5571]),o(t.data[5604]))})}function i(t){var e=/(?:&|\?)searchKey=([^&]+)/.exec(location.search);e&&e[1]&&h.val(decodeURI(e[1]));var a=/(?:&|\?)filter=([^&]+)/.exec(location.search);a=a&&a[1],"shop"==a&&c(f.find("span")[1])}function c(t){$(t).is("span")&&(f.find("span").removeClass("active"),$(t).addClass("active"),v=$(t).index(),h.attr("placeholder",0==v?h.attr("data-placeholder"):""))}function s(){if(0==v){var t=$.trim($(this).val());if(t){if(w.lastVal==t)return void p.show();w.lastVal=t,w.cache[v]=w.cache[v]||{};var e=w.cache[v];clearTimeout(w.delayId),w.delayId=setTimeout(function(){e[t]?w.render(e[t]):$.ajax({url:w.url,data:{data:'{"keyword":"'+encodeURIComponent(t)+'"}'},dataType:"jsonp"}).then(function(a){e[t]=a,w.render(e[t])})},w.delayTime)}}}function l(t){var e=$(".active",p).removeClass("active");e.length?"up"==t?(e=e.prev(),e.length||(e=p.find(".item").last())):(e=e.next(),e.length||(e=p.find(".item").first())):e=p.find(".item").first(),e.addClass("active"),h.val(e.attr("data-title"))}function r(t){if(t=0==v?$.trim(t)||$.trim(h.attr("data-key")):$.trim(t)){var e=(encodeURIComponent(t),"http://www.meilishuo.com/search/goods/?page=1&searchKey="+encodeURIComponent(t));0!=v&&(e="http://www.meilishuo.com/search/shop/"+encodeURIComponent(t)+"?filter=shop"),location.href=e}}function d(){i(),n(),f.click(function(t){c(t.target)}),g?h.on("input",function(){s.call(this)}):h.on("propertychange",function(){s.call(this)}),h.on("blur",function(){setTimeout(function(){p.hide()},250)}).on("focus",function(){s.call(this)}).on("keyup",function(t){var e=t.keyCode;if(38==e||40==e){var a=38==e?"up":"down";l(a)}else 13==e&&r(this.value)}),p.on("mouseover",function(t){$(".item",this).removeClass("active"),$(t.target).closest(".item").addClass("active")}).on("click",function(t){var e=$(".active",this).attr("data-title"),a=t.target;r("span"==a.tagName.toLowerCase()?e+" "+$(a).text():e)}),m.on("click",function(){r(h.val())})}var h=$(".search-txt"),u=$(".hotword"),f=$(".search-tab"),p=$(".suggest-box"),m=$(".search-btn"),v=0,g="oninput"in document,w={lastVal:null,delayId:null,cache:{},url:"http://search.mogujie.com/jsonp/searchTipsMLS/1",delayTime:500,render:function(t){if(t&&t.success){for(var e=t.data.tips,a="",o=0;o<e.length;o++){for(var n=e[o].props,i="",c=0;c<n.length;c++)i+="<span>"+n[c].title+"</span>";a+='<div class="item" data-title="'+e[o].title+'">'+e[o].title+'<div class="tags">'+i+"</div></div>"}p.html(a).show()}else p.hide()}};d()});;fml.define("common/topbar",[],function(t,a){"use strict";function s(t){var a=$(".cart-goods"),s={marketType:"market_meilishuo",topNum:5};$.ajax({url:"http://cart.meilishuo.com/api/cart/miniCartList",data:s,dataType:"jsonp"}).then(function(s){if("1001"==s.status.code){var e="",o=s.result.cartItems?s.result.cartItems.length:0,r=Math.min(5,o);if(r>0){$(".cart-wrapper .hidden").addClass("down").removeClass("hidden"),t();for(var c=0;c<r;c++){for(var i=s.result.cartItems[c],n="",l=0,d=i.skuAttributes.length;l<d;l++){var p=i.skuAttributes[l];n+="<span>"+p.key+":"+p.value+"</span>&nbsp;&nbsp;"}e+='<li><a href="shopdetail.html#?'+i.itemIdEsc+'" target="_blank" style="padding: 0; float: left;"><span class="cart-goods-img" style="background: url('+i.imgUrl+') no-repeat; background-size: cover;"></span></a><div class="cart-goods-desc"><p><a href="shopdetail.html#?'+i.itemIdEsc+'" target="_blank" style="padding: 0; float: left;"><span class="cart-goods-title">'+i.title+'</span></a><span class="cart-goods-price">￥'+i.nowprice/100+'</span></p><p class="cart-goods-info"><span class="cart-goods-title">'+n+'</span><em class="del-cart-goods" data-stock="'+i.stockIdEsc+'"></em></p></div></li>'}a.html(e)}}})}function e(){$.ajax({url:"http://cart.meilishuo.com/api/cart/getItemCount",data:{marketType:"market_meilishuo"},dataType:"jsonp"}).then(function(t){var a=t.status,s=t.result.count>99?"99+":t.result.count;a.isLogin&&"1001"==a.code&&0!=s&&($(".cart .hidden").addClass(".down").removeClass(".hidden"),$(".my-cart").append('<span class="cart-num">'+s+"</span>"),$(".cart-account .num").text(s))})}function o(){s(e),$("#com-topbar").on("click",".del-cart-goods",function(){var t=$(this).closest("li"),a=$(this).closest(".down"),s=$(this).data("stock");$.ajax({url:"http://cart.meilishuo.com/api/cart/deleteCart",data:{marketType:"market_meilishuo",stockId:s},dataType:"jsonp"}).then(function(s){t.remove();var e=a.find(".cart-goods li").length;e||a.remove()})})}o()});;fml.define("core/etic",[],function(e,n){"use strict";function t(e,n,t){if(t&&checkTemplate(e,n),!r[e]){var c=document.getElementById(e).innerHTML;c=c.replace(/[\r\t\n]/g," ").split("<?").join("\t").replace(/((^|\?>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)\?>/g,"',$1,'").split("\t").join("');").split("?>").join(";p.push('").split("\r").join("\\'");try{r[e]=new Function("","var p=[];p.push('"+c+"');return p.join('');")}catch(e){if(console){console.log(e);var o=c.replace(/^[ ]*\'\)|p.push\(\'[ ]*\'\)|p.push\(\'/g,"").replace(/^[ ]*;|;[ ]*$/g,"");console.log(e.message+"   :   "+o);var l=document.createElement("script");l.innerHTML=o;try{new Function("",o)}catch(e){}}}}var p=r[e];if(!n)return p;try{return p.apply(n)}catch(e){console&&(console.log(e),console.log(n))}}var r={};return t});;fml.define("component/shareTmp",["core/etic"],function(e,t){"use strict";var c=e("core/etic");return function(e,t){t=t||Object;try{var r=c(e,t)}catch(e){fml.debug(e)}return r}});;fml.define("page/pcenter/common/navbar",[],function(a,e){"use strict";var c=window.location.pathname,n=window.location.protocol+"//"+window.location.hostname;switch(console.log(c,n),"coupon.html#"==c||"/pcenter/coupon"==c||"coupon.html#index"==c?c="coupon.html#index":"/account/bindNobile"!=c&&"/account/changeMobile"!=c||(c="bindMobile.html#"),c){case"coupon.html#index":$(".menu_coupon_plat").addClass("active");break;case"bindMobile.html#":$(".menu_bindmobile").addClass("active");break;case"setPersonal.html":$(".menu_setPersonal").addClass("active");break;case"setPassword.html#":$(".menu_setPassword").addClass("active");break;case"setAvatar.html#":$(".menu_setAvatar").addClass("active");break;case"payPassword.html#":$(".menu_payPassword").addClass("active");break;case"loginEqm.html#":$(".menu_loginEqm").addClass("active")}});;fml.define("page/account/common/captcha",[],function(t,a){"use strict";var c=function(){var t=$(".pic_list li");t.each(function(a){t.attr("data-click",0),$(this).html("<img style='left:-"+68*a+"px' src=''/>")}),$.ajax({url:"aj/aj_account/findPwd/captchaGetCode",data:{},dataType:"json",type:"GET",success:function(t){var a=t&&t.status||{},c=t&&t.result||{};a&&1001==a.code?(e(c.code),$("#authpic").attr("data-captkay",t.result.code),$(".errorMessage").html("").hide()):$(".errorMessage").html(a.msg||"请求图片验证码失败，请稍后再试").show()},error:function(){$(".errorMessage").html("请求图片验证码失败，请稍后再试").show()}})},e=function(t){var a="http://portal.meilishuo.com/api/validate/captcha/"+t,c=$(".pic_list li");c.each(function(t){c.attr("data-click",0),$(this).html("<img style='left:-"+68*t+"px' src='"+a+"'/>")})};$(".pic_list li").on("click",function(t){t&&t.stopPropagation?(t.stopPropagation(),t.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1);var a=$(this),c=a.attr("data-click"),e=a.find("img");e.css({top:-++c%4*68}),a.attr("data-click",c)}),c(),$("#change_pic").on("click",function(){c()})});;fml.define("page/account/changeMobile/step1",["component/shareTmp"],function(e,a){"use strict";var n=e("component/shareTmp"),t=$("#s_code"),o=$("#process_con"),s=$("#mobile"),c=$("#yanzhengma"),i=$("#acptchaForm"),r=$(".submitBox"),l=$("#send_next"),u=$("#code"),d=($("body"),$("#mobile"),$("#s_code2"),$("#change_bind"),{line_length:315,steps:[{done:!0,msg:"验证原手机"},{done:!1,msg:"设置新手机"},{done:!1,msg:"完成"}]}),h=null,m=!1;o.html(n("process",d));var f=function(e,a,n,t,o){$.ajax({url:e,type:n,data:a,dataType:"json",success:function(e){t&&t(e)},error:function(e,a){o(e,a)}})};t.on("click",function(){b()});var p=function(){$("#change_pic").trigger("click"),i.removeClass("none")},b=function(){var e=$(".sendErrorMsg"),a=60,n=t,o="/aj/aj_account/bindMobile/getChangeMobileSms",l=(s.val(),{});if(!i.hasClass("none")){var u=[];$("#authpic .pic_list li").each(function(e){var a=$(this);u.push(a.attr("data-click"))}),l.captkey=$("#authpic").attr("data-captkay")||"",l.captcode=u.join("_")}var d=function(a){var n=a&&a.status||{};a&&a.result||{};switch(n.code){case 1001:h(),c.show(),i.addClass("none"),r.show(),e.html("");break;case 40010003:p(),e.html("请旋转图形验证码后重新点击发送验证码");break;default:e.html(n.msg)}};f(o,l,"POST",d,function(){e.html("请求失败，请稍后再试")});var h=function(){g(a,function(e){e?($(n).attr("disabled","disabled"),$(n).addClass("check_password"),$(n).val("重新发送 ("+e+"秒)")):(m=!1,$(n).removeAttr("disabled"),$(n).removeClass("check_password"),$(n).val("发送验证码"))})}};l.on("click",function(){var e={code:u.val()};f("/aj/aj_account/bindMobile/checkChangeMobileSms",e,"POST",function(e){if(e&&e.status&&1001==e.status.code){var a=e&&e.result&&e.result.changeMobileToken||"";window.location.href="/account/changeMobile?token="+a+"&step=2"}else $(".bindErrorMessage").html(e&&e.status&&e.status.msg||"请求失败，请稍后再试")},function(){$(".bindErrorMessage").html("请求失败，请稍后再试")})});var g=function(e,a){h=window.setTimeout(function(){e&&(m?a(0):(e--,a(e),g(e,a)))},1e3)}});;fml.define("base",["common/topbar","common/search","common/nav","common/biu","common/ptpParams"],function(m,o){"use strict";m("common/topbar"),m("common/search"),m("common/nav"),m("common/biu"),m("common/ptpParams")});;